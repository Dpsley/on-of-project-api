# Как сливать ветки (CI) и осуществить поставку (CD)

## Тестовый полигон
Располагается по ссылке [api.tm-dev-test.ru](https://api.tm-dev-test.ru/).
У каждого участника проекта есть собственный инстанс проекта, называемый по паттерну `<имя_участника>.tm-dev-test.ru`.

После тестирования бекенда на своем адресе, необходимо закоммитить изменения, спуллить с ветки dev актуальную версию и залить изменения в ветку dev.
Деплой запускается автоматически, как только на ветке dev появляются обновления.

## Продакшн
Располагается по ссылке [api.traffic-meter.ru](https://api.traffic-meter.ru/).

После тестирования бекенда на тестовом полигоне, убедившись, что он нормально взаимодействует с тестовым фронтендом, доступным по ссылке [kabinet.tm-dev-test.ru](https://kabinet.tm-dev-test.ru/), необходимо открыть Pull request на слияние dev ветки с master веткой.

Деплой запускается автоматически, как только на ветке master появляются обновления.

> **Добавление новых участников в проект (для сисадмина)**
> 
> 1. Добавить поддомен на [reg.ru](https://reg.ru/) c www и без www
> 2. Создать новую одноименную директорию на timeweb
> 3. Заказать бесплатный SSL сертификат в эту директорию [timeweb.ru](https://hosting.timeweb.ru/ssl#order)
> 3. Через консоль перейти в эту директорию, удалить в ней всё
> 4. Склонировать туда проект `git clone git@github.com:MikhailArsentev/api.traffic-meter.ru.git .` (точка в конце обязательно, клонируем только содержимое)
> 5. Переключиться на фетку dev `git checkout dev`
> 6. Созадем символическую ссылку на ядро битрикса `ln -s /home/c/cu45551/api.tm-dev-test.ru/public_html/bitrix /home/c/cu45551/<имя_участника>.tm-dev-test.ru/public_html/bitrix`
> 7. Приглашаем его в репозиторий [github.com](https://github.com/MikhailArsentev/api.traffic-meter.ru/settings/access/)